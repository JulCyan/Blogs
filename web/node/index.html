<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>NodeJS | JulCyan</title>
    <meta name="generator" content="VuePress 1.5.1">
    
    <meta name="description" content="Full Stack Developer' Blogs">
    <link rel="preload" href="/Blogs/assets/css/0.styles.2761a623.css" as="style"><link rel="preload" href="/Blogs/assets/js/app.7cf5e789.js" as="script"><link rel="preload" href="/Blogs/assets/js/2.9c3fc760.js" as="script"><link rel="preload" href="/Blogs/assets/js/25.94bc3104.js" as="script"><link rel="prefetch" href="/Blogs/assets/js/10.b4037911.js"><link rel="prefetch" href="/Blogs/assets/js/11.4cfd1757.js"><link rel="prefetch" href="/Blogs/assets/js/12.a0d1cf31.js"><link rel="prefetch" href="/Blogs/assets/js/13.4938b412.js"><link rel="prefetch" href="/Blogs/assets/js/14.8b80c6fb.js"><link rel="prefetch" href="/Blogs/assets/js/15.0579c479.js"><link rel="prefetch" href="/Blogs/assets/js/16.2b8b3ff0.js"><link rel="prefetch" href="/Blogs/assets/js/17.ed967863.js"><link rel="prefetch" href="/Blogs/assets/js/18.8faaaaa2.js"><link rel="prefetch" href="/Blogs/assets/js/19.2dc747ac.js"><link rel="prefetch" href="/Blogs/assets/js/20.895e0256.js"><link rel="prefetch" href="/Blogs/assets/js/21.9f9f708e.js"><link rel="prefetch" href="/Blogs/assets/js/22.438cd8e6.js"><link rel="prefetch" href="/Blogs/assets/js/23.b97da440.js"><link rel="prefetch" href="/Blogs/assets/js/24.ebff0a09.js"><link rel="prefetch" href="/Blogs/assets/js/26.2bd44263.js"><link rel="prefetch" href="/Blogs/assets/js/27.a243c16f.js"><link rel="prefetch" href="/Blogs/assets/js/28.a1cdef03.js"><link rel="prefetch" href="/Blogs/assets/js/29.64971ea4.js"><link rel="prefetch" href="/Blogs/assets/js/3.0cf7f0ba.js"><link rel="prefetch" href="/Blogs/assets/js/30.8b4c18cb.js"><link rel="prefetch" href="/Blogs/assets/js/31.3a1caee7.js"><link rel="prefetch" href="/Blogs/assets/js/32.f6a9e98d.js"><link rel="prefetch" href="/Blogs/assets/js/4.2b3ec9cf.js"><link rel="prefetch" href="/Blogs/assets/js/5.9d2b49e1.js"><link rel="prefetch" href="/Blogs/assets/js/6.9ee930e5.js"><link rel="prefetch" href="/Blogs/assets/js/7.09428ab8.js"><link rel="prefetch" href="/Blogs/assets/js/8.a4f67595.js"><link rel="prefetch" href="/Blogs/assets/js/9.1d4f5386.js">
    <link rel="stylesheet" href="/Blogs/assets/css/0.styles.2761a623.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blogs/" class="home-link router-link-active"><!----> <span class="site-name">JulCyan</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blogs/web/basics/html/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/Blogs/web/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/Blogs/web/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/Blogs/web/node/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Node.js
</a></li></ul></div></div><div class="nav-item"><a href="/Blogs/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/Blogs/ops/linux.html" class="nav-link">
  OPS
</a></div><div class="nav-item"><a href="/Blogs/article/technologySelection.html" class="nav-link">
  Article
</a></div><div class="nav-item"><a href="/Blogs/repositories/" class="nav-link">
  Repositories
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blogs/web/basics/html/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/Blogs/web/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/Blogs/web/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/Blogs/web/node/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Node.js
</a></li></ul></div></div><div class="nav-item"><a href="/Blogs/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/Blogs/ops/linux.html" class="nav-link">
  OPS
</a></div><div class="nav-item"><a href="/Blogs/article/technologySelection.html" class="nav-link">
  Article
</a></div><div class="nav-item"><a href="/Blogs/repositories/" class="nav-link">
  Repositories
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Node.js</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blogs/web/node/" aria-current="page" class="active sidebar-link">Basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blogs/web/node/#repl" class="sidebar-link">REPL</a></li><li class="sidebar-sub-header"><a href="/Blogs/web/node/#命令行" class="sidebar-link">命令行</a></li><li class="sidebar-sub-header"><a href="/Blogs/web/node/#知识点" class="sidebar-link">知识点</a></li><li class="sidebar-sub-header"><a href="/Blogs/web/node/#module" class="sidebar-link">Module</a></li><li class="sidebar-sub-header"><a href="/Blogs/web/node/#global" class="sidebar-link">Global</a></li><li class="sidebar-sub-header"><a href="/Blogs/web/node/#mongodb" class="sidebar-link">MongoDB</a></li><li class="sidebar-sub-header"><a href="/Blogs/web/node/#md5加密" class="sidebar-link">md5加密</a></li><li class="sidebar-sub-header"><a href="/Blogs/web/node/#buffer" class="sidebar-link">Buffer</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="nodejs"><a href="#nodejs" class="header-anchor">#</a> <strong>NodeJS</strong></h1> <p>what's it?</p> <ul><li>一个开发平台: 有对应的编程语言、 有语言运行时(运行环境)、有能实现特定功能的API</li> <li>特点:
<ol><li>事件驱动(当事件被触发时, 执行传递过去的callback(回调函数))</li> <li>非阻塞 I/O模型 (当执行input/output操作时, 不会阻塞线程)</li> <li>单线程(JS就是单线程语言)</li> <li>拥有世界上最大的开源库生态系统 =&gt; npm</li></ol></li></ul> <h2 id="repl"><a href="#repl" class="header-anchor">#</a> REPL</h2> <p>全称: Read-Eval-Print-Loop(交互解释器)</p> <p>类似于Chrome console控制台</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
Read: 读取 -- 读取输入js数据结构并储存在内存中
Eval: 执行 -- 运行js数据结构
Print: 打印 -- 输出结构
Loop: 循环 --循环上述步骤

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>退出REPL: .exit or control + C{2}</p> <h2 id="命令行"><a href="#命令行" class="header-anchor">#</a> <strong>命令行</strong></h2> <p><strong>cmd</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
dir                       	 查看当前文件夹下所有文件/文件夹
cls 	           		    清屏
cd 文件名             		  进入该目录
cd.. 	           		    返回上级目录
cd/                      	返回顶级目录
cd 盘符名 回车 盘符名		 切换盘符目录
盘符名						切换盘符

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr> <p><strong>node</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
node			        		    开启REPL
node  js文件                          运行js代码
nodemon  js文件                       监控源代码更改并重新运行
node -version/v       		         查看node版本
node --inspect js文件                 node调试
node --inspect-brk js文件	            运行时启动断点调试
node --inspect=9229 js文件            非web服务断点调试
node --inspect-brk=9229 js文件        非web服务启动时开启断点调试

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr> <p><strong>npm</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
npm -version/v              查看npm版本
npm install/i 包名          本地安装

npm install/i 包名 -save    
自动修改package.json文件
下次使用本地安装时会自动将package.json中生产及开发依赖模块安装到node_module目录下

npm install/i 包名 -g       全局安装(可以使用包命令)
npm uninstall 包名		  卸载本地安装
npm uninstall 包名 -g		  卸载全局安装
npm install/i 包名@版本号    下载对应版本的包
npm install/i 包名@latest   下载最新版本的包
npm install/i npm@latest    下载最新版本的npm
npm init                    手动新建一个package.josn&amp;-loca.josn文件
npm init -yes/y             自动新建一个package.josn&amp;-loca.josn文件

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><hr> <h2 id="知识点"><a href="#知识点" class="header-anchor">#</a> 知识点</h2> <ul><li><p>路由:</p> <p>根据用户请求路径做出相应响应</p></li> <li><p>NodeJS的开发环境和生产环境:</p> <p>在package.json的依赖分别是dependencies(生产依赖)和devDependencies(开发依赖)，</p> <p>开发环境一般而言会在代码中部署诸多测试用的代码、警告甚至是库.</p> <p>而生产环境追求的是快速化、最小化，这些东西是没必要放到生产环境中的.</p> <p>总体来说:  dependencies放运行时需要的依赖  故用npm install 包 -save</p> <p>​	  devDependencies放像打包工具这些 故用npm install 包 -save-dev</p></li> <li><p>package.json:</p> <p>开发项目时首先用package.json描述, 故在项目根目录下用npm init -y</p> <p>安装第三方包时用package-loca.json文件描述, 故用npm install 包 -save</p></li> <li><p>POST请求</p> <p>post提交数据请求与提交文件请求的区别在于请求报文的请求头的不一样</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 普通post请求报文头 </span>
Content<span class="token operator">-</span>Type<span class="token operator">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
<span class="token comment">// 有文件上传的post请求报文头 </span>
Content<span class="token operator">-</span>Type<span class="token operator">:</span> multipart<span class="token operator">/</span>form<span class="token operator">-</span>data<span class="token punctuation">;</span> boundary<span class="token operator">=</span>…<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token number">165552698916225</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>故处理方式也不一样</p> <hr></li></ul> <h2 id="module"><a href="#module" class="header-anchor">#</a> <strong>Module</strong></h2> <ul><li><p>NodeJS内置模块使用</p> <p>直接引入: <code>Example: const http = require('http')</code></p></li> <li><p>第三方模块使用</p> <p>通过查看第三方模块的使用说明</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>normal
npm install packageName
<span class="token comment">// js</span>
<span class="token keyword">const</span> mime <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mime'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>能用require引入的是模块, 用package.json 描述的是包,并且包名内不能含有大写字母</p></li></ul> <hr> <h3 id="http"><a href="#http" class="header-anchor">#</a> <em><strong>http</strong></em></h3> <p>用于http服务器与客户端</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         		<span class="token comment">// 创建http服务器; return 实例化的http服务器</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  		<span class="token comment">// 注册请求响应事件</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'8888'</span><span class="token punctuation">,</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>		<span class="token comment">// 注册监听端口事件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="request"><a href="#request" class="header-anchor">#</a> <code>request</code></h4> <p>服务器解析http请求报文到request对象</p> <ul><li>request对象</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	request<span class="token punctuation">.</span>method				  <span class="token comment">// 请求方式</span>
	request<span class="token punctuation">.</span>httpVersion			  <span class="token comment">// 客户端http协议版本</span>
	request<span class="token punctuation">.</span>headers				 <span class="token comment">// 请求报文头 =&gt;一个对象</span>
	request<span class="token punctuation">.</span>rawHeaders			 <span class="token comment">// 原生请求报文头 =&gt;一个String数组</span>
	request<span class="token punctuation">.</span>url					 <span class="token comment">// 请求报文行里的请求路径(不包含host)</span>
	request<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 	  <span class="token comment">// 请求传递数据事件(会有多次传递)</span>
	request<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>	 <span class="token comment">// 请求结束传递数据事件</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr> <h4 id="response"><a href="#response" class="header-anchor">#</a> <code>response</code></h4> <p>服务器通过response对象向客户端发出响应</p> <ul><li>response对象</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	response<span class="token punctuation">.</span>statusCode		<span class="token comment">// 设置http 响应状态码</span>
	response<span class="token punctuation">.</span>statusMessage	<span class="token comment">// 设置http 响应状态码对应的message</span>
	response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// 设置http 响应报文头(default-不写也有; 复写报错)</span>
	response<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// 直接写入http 状态码以及响应报文头</span>
	response<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">// 设置http 响应正文</span>
	response<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>			<span class="token comment">// 必写,结束http响应, 可以写入响应正文</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// 设置响应报文跳转页面</span>
response<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">302</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span>statusMessage <span class="token operator">=</span> <span class="token string">'FOUND'</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Location'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// url是要跳转</span>
response<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 响应正文不能是js数据</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><hr> <h3 id="fs"><a href="#fs" class="header-anchor">#</a> <strong>fs</strong></h3> <p><code>Flie System</code> 文件系统, 用于操作文件/文件夹</p> <ul><li>fs常用</li></ul> <p>文件夹</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">madir</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>				<span class="token comment">// 新建文件夹</span>
fs<span class="token punctuation">.</span><span class="token function">mkdirSync</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>					<span class="token comment">// 同步新建文件夹</span>

fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> newName<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>	<span class="token comment">// 重命名文件夹</span>
<span class="token comment">// 需要有临时路径实现跨磁盘访问 =&gt; const form = new multiparty.From({uploadDir: upUrl})</span>
fs<span class="token punctuation">.</span>renameSync						<span class="token comment">// 同步重命名文件夹</span>

fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>				<span class="token comment">// 删除文件夹</span>
fs<span class="token punctuation">.</span>rmdirSync						<span class="token comment">// 同步删除文件夹</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>文件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>encoding<span class="token punctuation">,</span><span class="token keyword">default</span><span class="token operator">-</span><span class="token keyword">null</span><span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span>  
<span class="token comment">// 读, 参数2: encoding,根据字符编码读为string, 不传读为buffer二进制编码</span>

fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> content<span class="token punctuation">[</span><span class="token punctuation">,</span>encoding<span class="token punctuation">;</span><span class="token keyword">default</span><span class="token operator">-</span><span class="token string">'utf-8'</span><span class="token punctuation">]</span> <span class="token punctuation">,</span>callback<span class="token punctuation">)</span>  <span class="token comment">// 覆盖写入</span>
fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> content<span class="token punctuation">[</span><span class="token punctuation">,</span>encoding<span class="token punctuation">;</span><span class="token keyword">default</span><span class="token operator">-</span><span class="token string">'utf-8'</span><span class="token punctuation">]</span> <span class="token punctuation">,</span>callback<span class="token punctuation">)</span> <span class="token comment">// 追加写入</span>

fs<span class="token punctuation">.</span><span class="token function">unlink</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>		<span class="token comment">// 删除文件 return boolean</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><hr> <h3 id="path"><a href="#path" class="header-anchor">#</a> <strong>path</strong></h3> <p>用于处理文件与目录的路径</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> 文件夹<span class="token operator">/</span>文件名<span class="token operator">+</span><span class="token punctuation">)</span>	<span class="token comment">// return 拼接完成路径</span>
path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>				<span class="token comment">// return 当前文件的上级文件夹路径</span>
__filename 						<span class="token comment">// 当前文件完整绝对路径</span>
__dirname 						<span class="token comment">// 当前文件的上级文件夹完整绝对路径</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>__filename及 __dirname不是NodeJS的全局变量, 当运行node程序时nodeJS会将其放入
一个自执行函数(沙盒), f和d被作为函数的参数传入</p> <hr> <h3 id="url"><a href="#url" class="header-anchor">#</a> <strong>url</strong></h3> <p>用于 URL 处理与解析</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> urlObj <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">[</span><span class="token punctuation">,</span>parseQueryString<span class="token punctuation">[</span><span class="token punctuation">,</span>slashesDenoteHost<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">/* 将请求路径包含信息转为JS对象
 * param2:default-false; true将query部分通过querystring模块的parse()方法解析为JS对象
 * param3:default-false; true将解析hostname, example:{host:127.0.0.1,path:.....}
 * return 一个包含请求数据的JS对象
*/</span>

<span class="token comment">// 以下路径都不包含host信息 (主机地址,http协议号,端口号)</span>
urlObj<span class="token punctuation">.</span>pathname		 <span class="token comment">// 路径名(不包含get提交数据)</span>
urlObj<span class="token punctuation">.</span>path			<span class="token comment">// 完整路径名(包含get提交数据)</span>
urlObj<span class="token punctuation">.</span>query	    <span class="token comment">// get请求提交数据</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><hr> <h3 id="querystring"><a href="#querystring" class="header-anchor">#</a> querystring</h3> <p>用于解析请求路径数据</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> querystring <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>urlObj<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span> 					<span class="token comment">// return 将get请求提交数据转换后的JS对象</span>
querystring<span class="token punctuation">.</span><span class="token function">unescape</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>					<span class="token comment">// return 解析后的请求路径pathname</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><hr> <h3 id="multiparty-3rdp"><a href="#multiparty-3rdp" class="header-anchor">#</a> multiparty-3rdP</h3> <p>用于处理post提交文件请求</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> form <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">multiparty<span class="token punctuation">.</span>From</span><span class="token punctuation">(</span><span class="token punctuation">{</span>uploadDir<span class="token operator">:</span> url<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 传递给form对象的uploadDir一个值, 作为临时路径保证可以跨磁盘访问</span>
<span class="token keyword">from</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> files<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>	<span class="token comment">// 解析客户端表单提交数据</span>
<span class="token comment">// 参数2: 表单提交的字段 取值  fields[keys][0] 对应的键是一个数组</span>
<span class="token comment">// 参数3: 表单提交的文件 取值同 fields</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr> <h3 id="multer"><a href="#multer" class="header-anchor">#</a> <strong>multer</strong></h3> <p>用于处理form data</p> <hr> <p>###mime-3rdP</p> <p>用于检测文件类型 npm install mime -g</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> mime <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mime'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mime<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>文件url<span class="token punctuation">)</span> 		<span class="token comment">// 得到文件的Content-Type</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><hr> <h3 id="express-3rdp"><a href="#express-3rdp" class="header-anchor">#</a> <em><strong><code>express</code>-3rdP</strong></em></h3> <p>基于 NodeJS 平台，快速、开放、极简的 Web 开发框架</p> <h4 id="实例化的app"><a href="#实例化的app" class="header-anchor">#</a> <em><strong><code>实例化的app</code></strong></em></h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>	
<span class="token comment">// http接收post请求时利用bodyParser模块的urlencoded将请求体解析为JS对象</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token comment">// 设置请求静态资源时转接的根目录</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> oneRouter<span class="token punctuation">)</span>
<span class="token comment">// 设置路由中间件; 当请求路径为param1时转接到oneRouter下</span>
<span class="token comment">// param1: 请求路径</span>
<span class="token comment">// param2: 转接路由模块</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>		<span class="token comment">// 不区分请求方式 且请求路径开头  符合即可</span>
app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>		<span class="token comment">// 不区别请求方式 但请求路径  必须完全符合</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>		<span class="token comment">// 设置接收get请求时的响应</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>		<span class="token comment">// 设置接收post请求时的响应</span>

<span class="token comment">// 用以检测所有包含关键字的请求, 以是否设置 req.session.xxx 检测拦截</span>
app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>	
    <span class="token comment">// 只要是请求后台就要先检测有没有登录</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;studentmanager&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>loginedName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 请求继续</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;script&gt;alert(\&quot;请先登录\&quot;);location.href = 					'http://127.0.0.1:8000/account/login'&lt;/script&gt;&gt;&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">,</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>	<span class="token comment">// 设置监听端口</span>


<span class="token comment">// 定义模板引擎</span>
npm install jade <span class="token operator">-</span>save	<span class="token comment">// example</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 指定模板文件存放位置</span>

<span class="token comment">// 设置默认的模板引擎</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'jade'</span><span class="token punctuation">)</span>  

<span class="token comment">// 若是需要更改文件后缀名</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">'.html'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jade'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__express<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">)</span>

在指定的模板引擎文件夹下创建 index<span class="token punctuation">.</span>jade
使用res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 自动替换完成后渲染给浏览器

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><hr> <p>####req与res</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	request<span class="token punctuation">.</span>query 		<span class="token comment">// 一个包含get请求提交数据的JS对象</span>
	request<span class="token punctuation">.</span>body  		<span class="token comment">// 一个包含post请求提交数据的JS对象</span>
		<span class="token comment">// 需要使用 app.use(bodyParser.urlencoded({ extended: false }))</span>
    
	response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 	<span class="token comment">// 设置响应报文状态码; return response对象</span>
	response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">// 设置响应正文, 转为JSON 参数是arr,或obj, 这时它与response.send()方法一致</span>
	response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">// 设置响应正文</span>
	<span class="token comment">// param: Buffer, arr, obj, str, 根据传递数据的不同自动设置不同的响应头</span>
	response<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">// 设置响应正文, 只能自动设置Buffer和html 的响应头</span>
    
	response<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">// 设置响应头</span>
	response<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>	<span class="token comment">// 设置跳转, 自动设置状态码302及状态码对应信息FOUND</span>
	response<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>		<span class="token comment">// 读取文件并自动渲染给浏览器</span>
	response<span class="token punctuation">.</span><span class="token function">location</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>		<span class="token comment">// 跳转页面</span>
    
   	<span class="token comment">// 必须给express设置模板引擎才能使用</span>
	response<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>view <span class="token punctuation">[</span><span class="token punctuation">,</span>locals<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">,</span>callback<span class="token punctuation">]</span><span class="token punctuation">)</span> 
    <span class="token comment">// param1: 读取文件的路径</span>
    <span class="token comment">// param2: 读取文件进行模板替换的数据</span>
    <span class="token comment">// param3: 回调函数有err, content两个参数</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'index/:year/:mouth/:day'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>params		<span class="token comment">//	获取以 /index/2018/11/15形式传参的参数对象</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><hr> <p>####***<code>Router路由模块</code>***</p> <p>用于express处理请求的分类处理</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 注意: 路由模块一定要用module.exports导出 否则会报错</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> oneRouter <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 创建路由中间件(路由模块);</span>
oneRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>					 <span class="token comment">// 设置路由</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> oneRouter<span class="token punctuation">;</span> 		<span class="token comment">// 导出路由模块</span>
module<span class="token punctuation">.</span>exposts<span class="token punctuation">.</span><span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>		<span class="token comment">// 给模块添加一个fn 方法并导出, 可以省略module JS内置</span>
<span class="token comment">// 服务器入口文件</span>
	<span class="token keyword">const</span> oneRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 引入路由中间件</span>
	app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/man'</span><span class="token punctuation">,</span> manRouter<span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// 使用路由中间件</span>
<span class="token comment">// 使用服务器入口路由还是路由模块由书写顺序决定  (JS是单线程从上到下执行)</span>



<span class="token comment">// 路由控制器Controller =&gt; 路由模块处理请求函数的集合 与express无关, JS内置方法</span>

<span class="token comment">// 写法</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">fn1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>	<span class="token comment">// 导出路由控制器模块方法</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">fn2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 用法</span>
<span class="token keyword">const</span> routerControl <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 引入</span>
<span class="token comment">// 路由模块处理请求时</span>
oneRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> routerControl<span class="token punctuation">.</span>fn1<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 调用路由控制器方法进行处理</span>
为什么这样做<span class="token operator">?</span>		<span class="token parameter">个人理解</span> <span class="token operator">=&gt;</span> 模块化开发
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><hr> <p>####express-session-3rdP</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 配置session</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'connect-sid'</span><span class="token punctuation">,</span>    <span class="token comment">// 返回给客户端session名</span>
    secret<span class="token operator">:</span> <span class="token string">'session-name'</span><span class="token punctuation">,</span> <span class="token comment">// 服务器生成session的签名</span>
    resave <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>           <span class="token comment">// 一个请求在另一个请求结束时对session进行修改覆盖并保存，默认值为true</span>
    cookie<span class="token operator">:</span> <span class="token punctuation">{</span>  <span class="token comment">// 配置cookie</span>
        maxAge<span class="token operator">:</span> <span class="token number">60</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">,</span>    <span class="token comment">// cookie的寿命</span>
        httpOnly<span class="token operator">:</span> <span class="token boolean">true</span>      <span class="token comment">// 是否允许脚本修改cookie, true可以防止xss 攻击</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 当接受请求时</span>
req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>xxx <span class="token operator">=</span> xxx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><hr> <h3 id="body-parser-3rdp"><a href="#body-parser-3rdp" class="header-anchor">#</a> body-parser-3rdP</h3> <p>一般用于express里解析post请求提交数据</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 					<span class="token comment">// 利用express模块实例化http服务器</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// http接收post请求时利用bodyParser模块的urlencoded将请求体编译为JS对象</span>
request<span class="token punctuation">.</span>body  							<span class="token comment">// 一个包含post请求提交数据的JS对象</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><hr> <p>###captchapng-3rdP</p> <p>用于生成验证码图片</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 使用</span>
<span class="token comment">/**
 * Captcha PNG img generator
 * @Author: George Chan
 * @Email: gchan@21cn.com
 * @Version: 1.0
 * @Date: 2013-08-18
 * @license http://www.opensource.org/licenses/bsd-license.php BSD License
 */</span>
 
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> captchapng <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'captchapng'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url <span class="token operator">==</span> <span class="token string">'/captcha.png'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">captchapng</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">9000</span><span class="token operator">+</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token comment">// 宽, 高, 验证码</span>
        p<span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 设置背景颜色及透明度 透明度0-255</span>
        p<span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置文字颜色及透明度</span>
        <span class="token keyword">var</span> img <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">getBase64</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
        <span class="token keyword">var</span> imgbase64 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'image/png'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>imgbase64<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> response<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8181</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><hr> <p>###<em>others 3rd Party Module</em></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>date<span class="token operator">-</span>format

<span class="token keyword">const</span> dataFormat <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'data-format'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 该实例对象是一个函数</span>
<span class="token function">dataFormat</span><span class="token punctuation">(</span><span class="token string">'yyyyMMddhhmmssSSS'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// return 本地时间的数字字符串</span>


util

<span class="token keyword">const</span> util <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'util'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
util<span class="token punctuation">.</span><span class="token function">inspect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// return 一个字符串形式的JS数据(并不是JSON对象)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr> <h2 id="global"><a href="#global" class="header-anchor">#</a> <em><strong>Global</strong></em></h2> <p><code>全局变量在所有模块中均可使用</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 以下变量虽然看起来像全局变量，但实际上不是。 它们的作用域只在模块内 </span>
	__dirname
	__filename
	exports
	module
	<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><hr> <h3 id="class-buffer"><a href="#class-buffer" class="header-anchor">#</a> <strong>Class:Buffer</strong></h3> <p>缓冲用于处理二进制数据</p> <p>Buffer 类的实例类似于整数数组，但Buffer 的大小是固定的、且在V8 堆外分配物理内存。Buffer 的大小在被创建时确定，且无法调整。</p> <p>Static method</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>chunkList<span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">// 拼接chunks(数据块); return 拼接完成的chunks</span>
<span class="token comment">// chunks必须转为字符串(toString())才能被querystring.parse()解析</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><hr> <h2 id="mongodb"><a href="#mongodb" class="header-anchor">#</a> <em><strong>MongoDB</strong></em></h2> <p>MongoDB是一个基于分布式文件存储的数据库</p> <p>在JS中操作MongoDB数据库的MongoDB模块基本使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入操作MongoDB 的模块</span>
<span class="token keyword">const</span> MongoClient <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span>

<span class="token comment">// 用于解析数据传输后的_id 以匹配数据库集合中对应_id的数据</span>
<span class="token keyword">const</span> ObjectId <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ObjectId<span class="token punctuation">;</span>	<span class="token comment">// 用法: ObjectId(实例_id) return 集合中_id	</span>

<span class="token keyword">const</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'assert'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// 用以检测是否报错</span>
<span class="token comment">// mongoDB的位置</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">&quot;mongodb://localhost:27017&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 操作的数据库</span>
<span class="token keyword">const</span> dbName <span class="token operator">=</span> <span class="token string">'myFirstDB'</span><span class="token punctuation">;</span>
<span class="token comment">// 建立连接</span>
MongoClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>  <span class="token punctuation">{</span>
    useNewUrlParser<span class="token operator">:</span> <span class="token boolean">true</span> 	<span class="token comment">// 解决兼容</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> client</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> isOK <span class="token operator">=</span> assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 判断是否相等没有错误就是null</span>
    <span class="token keyword">let</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span>dbName<span class="token punctuation">)</span><span class="token punctuation">;</span> 		<span class="token comment">// 获取数据库</span>
    <span class="token keyword">let</span> user <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 获取集合</span>
    <span class="token comment">// 增加</span>
    user<span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">&quot;boss&quot;</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> sex<span class="token operator">:</span> <span class="token string">'男'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   	<span class="token comment">// 增加一项</span>
    user<span class="token punctuation">.</span><span class="token function">insertMany</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">&quot;yihao&quot;</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'erhao'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//增加多项</span>
    
   	<span class="token comment">// 修改</span>
    user<span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;小弟&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>$<span class="token keyword">set</span> <span class="token operator">:</span> <span class="token punctuation">{</span>age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// 修改匹配到的第一个 </span>
    user<span class="token punctuation">.</span><span class="token function">updataMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 		<span class="token comment">//修改全部匹配项</span>
    
    <span class="token comment">// 删除</span>
    user<span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'chenshuai'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//删除匹配到的第一个</span>
    user<span class="token punctuation">.</span><span class="token function">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 修改全部匹配项</span>
    
    <span class="token comment">// 查找</span>
    user<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">&quot;chenshuai&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// doc 以数组形式存储全部匹配项 </span>
        <span class="token comment">// 查找所有 find({})</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 查找全部匹配项</span>
    user<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">&quot;chenshuai&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// result 以对象形式存储一条匹配项</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 模糊查询</span>
    user<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token regex">/chen/</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 使用正则表达式进行模糊查询</span>
    user<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token punctuation">{</span>$regex<span class="token operator">:</span> <span class="token string">'chen'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    client<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭数据库连接</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p>##***<code>xtpl</code>***</p> <p>NodeJS中常用的模板引擎常用模板引擎</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>npm install xtpl xtemplate -save
npm install express -save
// 模板语法
<span class="token doctype">&lt;!DOCTYPE html&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        {{{ block('content') }}}  // 占位
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

// 替换模板
{{extend('./views/index.html')}}	// 链入父级模板, 引入链接模板时会自动引入其他模板
  {{#block('content')}}
  	{{#each(students)}}
  		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>body teacher-profile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      		{{this.name}}
  		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  	{{/each}}
  {{/block}}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> txpl <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'xtpl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 自动渲染</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>viewPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">'.html'</span><span class="token punctuation">,</span> xtpl<span class="token punctuation">.</span>__express<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// 手动渲染</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xtpl<span class="token punctuation">.</span><span class="token function">renderFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token operator">/</span>views<span class="token operator">/</span>index<span class="token punctuation">.</span>html<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> content</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="md5加密"><a href="#md5加密" class="header-anchor">#</a> md5加密</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;/js/jquery.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;/js/md5.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token keyword">var</span> password <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#passwordId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;HM17NIUBI&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="buffer"><a href="#buffer" class="header-anchor">#</a> Buffer</h2> <p>思考：Buffer 类型产生的原因？主要用来解决什么问题？</p> <p>看一下什么是 Buffer? 什么是 Stream?</p> <p>一、类型介绍</p> <ol><li>JavaScript 语言没有读取或操作二进制数据流的机制。</li> <li>Node.js 中引入了 Buffer 类型使我们可以操作 TCP流 或 文件流。</li> <li>Buffer 类型的对象类似于整数数组，但 Buffer 的大小是固定的、且在 V8 堆外分配物理内存。 Buffer 的大小在被创建时确定，且无法调整。（ buf.length 是固定的，不允许修改 ）</li> <li>Buffer 是全局的，所以使用的时候无需 require() 的方式来加载</li></ol> <p>二、如何创建一个 Buffer 对象</p> <p>常见的 API 介绍</p> <ol><li>创建一个 Buffer 对象</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 1. 通过 Buffer.from() 创建一个 Buffer 对象</span>

<span class="token comment">// 1.1 通过一个字节数组来创建一个 Buffer 对象</span>
<span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x8c</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> buf <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1.2 通过字符串来创建一个 Buffer 对象</span>
<span class="token comment">// Buffer.from(string[, encoding])</span>
<span class="token keyword">var</span> buf <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'你好世界！ Hello World!~'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="2"><li>拼接多个 Buffer 对象为一个对象</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Buffer.concat(list[, totalLength])</span>
<span class="token keyword">var</span> bufferList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> buf <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>bufferList<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="3"><li>获取字符串对应的字节个数</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Buffer.byteLength(string[, encoding])</span>

<span class="token keyword">var</span> len <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">byteLength</span><span class="token punctuation">(</span><span class="token string">'你好世界Hello'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="4"><li>判断一个对象是否是 Buffer 类型对象</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Buffer.isBuffer(obj)</span>
<span class="token comment">// obj &lt;Object&gt;</span>
<span class="token comment">// Returns: &lt;boolean&gt;</span>
<span class="token comment">// Returns true if obj is a Buffer, false otherwise.</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="5"><li>获取 Buffer 中的某个字节</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 根据索引获取 Buffer 中的某个字节（byte、octet）</span>
<span class="token comment">// buf[index]</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>6、获取 Buffer 对象中的字节的个数</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// buf.length</span>
<span class="token comment">// 注意：length 属性不可修改</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="7"><li>已过时的 API</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 以下 API 已全部过时</span>
<span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>arrayBuffer<span class="token punctuation">[</span><span class="token punctuation">,</span> byteOffset <span class="token punctuation">[</span><span class="token punctuation">,</span> length<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">,</span> encoding<span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>三、Buffer 对象与编码</p> <p>Node.js 目前支持的编码如下：</p> <ol><li>ascii</li> <li>utf8</li> <li>utf16le</li></ol> <ul><li>ucs2 是 utf16le 的别名</li></ul> <ol start="4"><li>base64</li> <li>latin1</li></ol> <ul><li>binary 是 latin1 的别名</li></ul> <ol start="6"><li>hex</li></ol> <ul><li>用两位 16 进制来表示每个字节</li></ul> <p>示例代码：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
<span class="token keyword">var</span> buf <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'你好世界，Hello World！'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>四、思考：为什么会有 Buffer 类型？</p> <ol><li>Buffer 使用来临时存储一些数据（二进制数据）</li> <li>当我们要把一大块数据从一个地方传输到另外一个地方的时候可以通过 Buffer 对象进行传输</li> <li>通过 Buffer 每次可以传输小部分数据，直到所有数据都传输完毕。</li></ol> <p>五、补充</p> <ol><li><p>Stream</p></li> <li><p>Writable Stream</p></li></ol> <ul><li>允许 node.js 写数据到流中</li></ul> <ol start="3"><li>Readable Stream</li></ol> <ul><li>允许 node.js 从流中读取数据</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/Blogs/assets/js/app.7cf5e789.js" defer></script><script src="/Blogs/assets/js/2.9c3fc760.js" defer></script><script src="/Blogs/assets/js/25.94bc3104.js" defer></script>
  </body>
</html>
